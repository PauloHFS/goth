pre-commit:
  parallel: true
  commands:
    format:
      run: gofmt -s -w .
    generate:
      run: make generate css
      stage_fixed: true

commit-msg:
  commands:
    commitlint:
      run: |
        msg=$(cat .git/COMMIT_EDITMSG)
        if ! echo "$msg" | grep -qE "^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .{1,72}"; then
          echo "Commit message must follow Conventional Commits: type(scope): subject"
          exit 1
        fi

pre-push:
  parallel: true
  commands:
    vuln-check:
      run: go tool govulncheck ./...
    test:
      run: make test
    lint:
      run: golangci-lint run --timeout=5m
